{% extends 'main/base.html' %}
{% block employes_active %}active{% endblock %}
{% block content %}
    <h1 class="text-3xl font-bold mb-4">Bonjour </h1>
    <p class="text-gray-700">Logged in as: {{ user.matricule }}</p>

    <h2 class="text-blue-950 text-xl font-bold">Employee List:</h2>

    <!-- Search Form -->
    <div class="border h-3/5 p-2 max-h-96">
        <form method="GET" action="">
            <label class="relative block mx-5 w-60">
                <span class="sr-only">Search</span>
                <span class="absolute inset-y-0 left-0 flex items-center pl-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                    </svg>
                </span>
                <input
                    class="placeholder:italic placeholder:text-slate-400 block bg-white w-full border border-slate-300 rounded-md py-2 pl-9 pr-3 shadow-sm focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1 sm:text-sm"
                    placeholder="Search for anything..."
                    type="text"
                    name="search"
                    value="{{ search_query }}"  
                />
            </label>
            <button type="submit">Search</button>  <!-- Submit the search query to the server -->
        </form>

        <!-- Employee Table -->
        <div class="max-h-[300px] overflow-auto">
            <table id="employeeTable" class="table-fixed w-full">
                <thead class="text-gray-500 sticky top-0 bg-white">
                    <tr>
                        <th class="font-normal text-left py-4 px-4">Nom & Prenom</th>
                        <th class="font-normal text-left py-4 px-4">Matricule</th>
                        <th class="font-normal text-left py-4 px-4">Unit√©</th>
                        <th class="font-normal text-left py-4 px-4">Status</th>
                        <th class="font-normal text-left py-4 px-4">Date de Naissance</th>
                    </tr>
                </thead>
                <tbody>
                    {% for employee in page.object_list %}
                    <tr class="border-t border-b">
                        <td class="px-4 py-4 first-letter:uppercase">{{ employee.nom }} {{ employee.prenom }}</td>
                        <td class="text-gray-900 px-4 py-4">{{ employee.matricule }}</td>
                        <td class="text-gray-900 px-4 py-4">{{ employee.unite }}</td>
                        {% if employee.status == "actif" %}
                        <td class="p-0"><div class="text-green-600 text-center font-medium bg-gray-100 rounded-md w-28">{{ employee.status }}</div></td>
                        {% else %}
                        <td class="text-red-600 bg-gray-200 rounded-md">{{ employee.status }}</td>
                        {% endif %}
                        <td class="text-gray-900 px-4 py-4">{{ employee.date_de_naissance | date:"Y-m-d" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Pagination Controls -->
        <div class="pagination-controls mt-4 text-center">
            {% if page.has_previous %}
            <a class="px-2" href="?page={{ page.previous_page_number }}&search={{ search_query }}">Previous</a>
            {% endif %}

            {% for page_num in page.paginator.page_range %}
            <a class="px-2 {% if page.number == page_num %} font-bold {% endif %}" href="?page={{ page_num }}&search={{ search_query }}">{{ page_num }}</a>
            {% endfor %}

            {% if page.has_next %}
            <a class="px-2" href="?page={{ page.next_page_number }}&search={{ search_query }}">Next</a>
            {% endif %}
        </div>
    </div>
{% endblock %}
